"use strict";(self.webpackChunkttech_assessment=self.webpackChunkttech_assessment||[]).push([[792],{792:(N,v,a)=>{a.r(v),a.d(v,{BooksModule:()=>W});var f=a(9808),y=a(4100),p=a(3075),u=a(4004),L=a(1520),d=a(9300),k=a(9468),S=a(8372),s=a(5e3),n=a(520);const G=new class w{encodeKey(i){return encodeURIComponent(i)}encodeValue(i){return encodeURIComponent(i)}decodeKey(i){return decodeURIComponent(i)}decodeValue(i){return decodeURIComponent(i)}};var m=a(764);let P=(()=>{class o{constructor(){this.rootUrl="https://api.nytimes.com/svc/books/v2"}}return o.\u0275fac=function(e){return new(e||o)},o.\u0275prov=s.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})(),T=(()=>{class o extends class B{constructor(i,e){this.config=i,this.http=e,this._rootUrl=""}get rootUrl(){return this._rootUrl||this.config.rootUrl}set rootUrl(i){this._rootUrl=i}newParams(){return new n.LE({encoder:G})}}{constructor(e,t){super(e,t)}GETListsFormatResponse(e){let t=this.newParams(),r=new n.WM;null!=e.list&&(t=t.set("list",e.list.toString())),null!=e.publishedDate&&(t=t.set("published-date",e.publishedDate.toString())),null!=e.offset&&(t=t.set("offset",e.offset.toString())),null!=e.bestsellersDate&&(t=t.set("bestsellers-date",e.bestsellersDate.toString()));let c=new n.aW("GET",this.rootUrl+`/lists.json?api-key=${m.q}`,null,{headers:r,params:t,responseType:"json"});return this.http.request(c).pipe((0,d.h)(l=>l instanceof n.Zn),(0,u.U)(l=>l))}GETListsFormat(e){return this.GETListsFormatResponse(e).pipe((0,u.U)(t=>t.body))}GETListsDateListJsonResponse(e){let t=this.newParams(),r=new n.WM;null!=e.offset&&(t=t.set("offset",e.offset.toString()));let c=new n.aW("GET",this.rootUrl+`/lists/${encodeURIComponent(String(e.date))}/${encodeURIComponent(String(e.list))}.json?api-key=${m.q}`,null,{headers:r,params:t,responseType:"json"});return this.http.request(c).pipe((0,d.h)(l=>l instanceof n.Zn),(0,u.U)(l=>l))}GETListsDateListJson(e){return this.GETListsDateListJsonResponse(e).pipe((0,u.U)(t=>t.body))}GETListsFullOverviewFormatResponse(e){let t=this.newParams(),r=new n.WM;null!=e&&(t=t.set("published_date",e.toString()));let c=new n.aW("GET",this.rootUrl+`/lists/full-overview.json?api-key=${m.q}`,null,{headers:r,params:t,responseType:"json"});return this.http.request(c).pipe((0,d.h)(l=>l instanceof n.Zn),(0,u.U)(l=>l))}GETListsFullOverviewFormat(e){return this.GETListsFullOverviewFormatResponse(e).pipe((0,u.U)(t=>t.body))}GETListsOverviewFormatResponse(e){let t=this.newParams(),r=new n.WM;null!=e&&(t=t.set("published_date",e.toString()));let c=new n.aW("GET",this.rootUrl+`/lists/overview.json?api-key=${m.q}`,null,{headers:r,params:t,responseType:"json"});return this.http.request(c).pipe((0,d.h)(l=>l instanceof n.Zn),(0,u.U)(l=>l))}GETListsOverviewFormat(e){return this.GETListsOverviewFormatResponse(e).pipe((0,u.U)(t=>t.body))}GETListsNamesFormatResponse(){let e=this.newParams(),t=new n.WM,h=new n.aW("GET",this.rootUrl+`/lists/names.json?api-key=${m.q}`,null,{headers:t,params:e,responseType:"json"});return this.http.request(h).pipe((0,d.h)(c=>c instanceof n.Zn),(0,u.U)(c=>c))}GETListsNamesFormat(){return this.GETListsNamesFormatResponse().pipe((0,u.U)(e=>e.body))}GETListsBestSellersHistoryJsonResponse(e){let t=this.newParams(),r=new n.WM;null!=e.title&&(t=t.set("title",e.title.toString())),null!=e.publisher&&(t=t.set("publisher",e.publisher.toString())),null!=e.price&&(t=t.set("price",e.price.toString())),null!=e.offset&&(t=t.set("offset",e.offset.toString())),null!=e.isbn&&(t=t.set("isbn",e.isbn.toString())),null!=e.contributor&&(t=t.set("contributor",e.contributor.toString())),null!=e.author&&(t=t.set("author",e.author.toString())),null!=e.ageGroup&&(t=t.set("age-group",e.ageGroup.toString()));let c=new n.aW("GET",this.rootUrl+`/lists/best-sellers/history.json?api-key=${m.q}`,null,{headers:r,params:t,responseType:"json"});return this.http.request(c).pipe((0,d.h)(l=>l instanceof n.Zn),(0,u.U)(l=>l))}GETListsBestSellersHistoryJson(e){return this.GETListsBestSellersHistoryJsonResponse(e).pipe((0,u.U)(t=>t.body))}GETReviewsFormatResponse(e){let t=this.newParams(),r=new n.WM;null!=e.title&&(t=t.set("title",e.title.toString())),null!=e.isbn&&(t=t.set("isbn",e.isbn.toString())),null!=e.author&&(t=t.set("author",e.author.toString()));let c=new n.aW("GET",this.rootUrl+`/reviews.json?api-key=${m.q}`,null,{headers:r,params:t,responseType:"json"});return this.http.request(c).pipe((0,d.h)(l=>l instanceof n.Zn),(0,u.U)(l=>l))}GETReviewsFormat(e){return this.GETReviewsFormatResponse(e).pipe((0,u.U)(t=>t.body))}}return o.GETListsFormatPath="/lists.json",o.GETListsDateListJsonPath="/lists/{date}/{list}.json",o.GETListsFullOverviewFormatPath="/lists/full-overview.json",o.GETListsOverviewFormatPath="/lists/overview.json",o.GETListsNamesFormatPath="/lists/names.json",o.GETListsBestSellersHistoryJsonPath="/lists/best-sellers/history.json",o.GETReviewsFormatPath="/reviews.json",o.\u0275fac=function(e){return new(e||o)(s.LFG(P),s.LFG(n.eN))},o.\u0275prov=s.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})(),b=(()=>{class o{constructor(e){this.bookApiService=e}transformList(e){var t;return null===(t=null==e?void 0:e.replace(" ","-"))||void 0===t?void 0:t.toLocaleLowerCase()}getBooks(e){return this.bookApiService.GETReviewsFormat(e).pipe((0,u.U)(t=>t.results))}getBookList(e){return e.list=this.transformList(e.list),this.bookApiService.GETListsDateListJson(e).pipe((0,u.U)(t=>t.results))}}return o.\u0275fac=function(e){return new(e||o)(s.LFG(T))},o.\u0275prov=s.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})();var E=a(4831),F=a(7322),U=a(4107),I=a(508),g=a(8777),C=a(2068);const R=["scroller"];function Z(o,i){if(1&o&&(s.TgZ(0,"mat-option",14),s._uU(1),s.qZA()),2&o){const e=i.$implicit;s.Q6J("value",e.value),s.xp6(1),s.hij(" ",e.viewValue," ")}}function A(o,i){if(1&o&&(s.ynx(0),s.TgZ(1,"div",15)(2,"app-card-item",16),s._uU(3,"tERST"),s.qZA()(),s.BQk()),2&o){const e=i.$implicit;s.xp6(2),s.Q6J("data",e)}}function j(o,i){1&o&&(s.TgZ(0,"h1"),s._uU(1,"Loading"),s.qZA())}function J(o,i){1&o&&(s.TgZ(0,"h1"),s._uU(1,"No data"),s.qZA())}const M=[{path:"",component:(()=>{class o{constructor(e,t){this.booksLocalService=e,this.ngZone=t,this.pageTitle="Books",this.paginatedListItems=[{}],this.itemsPerpage=10,this.currentPage=0,this.loading=!0,this.dafaultParam={list:"Expeditions Disasters And Adventures",date:"current",offset:this.currentPage},this.searchBarForm=new p.cw({searchInputField:new p.NI("")}),this.searchSelectForm=new p.cw({selectSearchField:new p.NI("")}),this.searchByList=[{viewValue:"_",value:""},{viewValue:"Author",value:"author"},{viewValue:"ISBN",value:"isbn"},{viewValue:"Title",value:"title"}]}ngOnInit(){this.getBooks(this.dafaultParam),this.searchFormGroup(),this.selectSortFormGroup()}ngAfterViewInit(){this.scroller.elementScrolled().pipe((0,u.U)(()=>this.scroller.measureScrollOffset("bottom")),(0,L.G)(),(0,d.h)(([e,t])=>t<e&&t<140),(0,k.p)(200)).subscribe(()=>{this.ngZone.run(()=>{var e;this.paginatedListItems=[...this.paginatedListItems,...null===(e=this.listItems)||void 0===e?void 0:e.splice(0,this.itemsPerpage)]})})}getBooks(e){this.booksLocalService.getBookList(e).subscribe(t=>{var r;this.listItems=null==t?void 0:t.map(h=>this.transformData(h)),this.paginatedListItems=null===(r=this.listItems)||void 0===r?void 0:r.splice(0,this.itemsPerpage),this.loading=!1,console.log("asdf",t)},t=>this.loading=!1)}getBooksWithParam(e){this.booksLocalService.getBooks(e).subscribe(t=>{var r;console.log("ff",t),this.listItems=null==t?void 0:t.map(h=>this.tranformBooksWithParamData(h)),this.paginatedListItems=null===(r=this.listItems)||void 0===r?void 0:r.splice(0,this.itemsPerpage),this.loading=!1},t=>this.loading=!1)}transformData(e){return{title:e.book_details[0].title,multimedia:e.book_details[0].book_image?[{url:e.book_details[0].book_image}]:null,byline:e.book_details[0].author,abstract:e.book_details[0].description}}tranformBooksWithParamData(e){return{title:e.title,multimedia:e.book_details[0].book_image?[{url:e.book_details[0].book_image}]:null,byline:e.author,abstract:e.book_details[0].description}}searchFormGroup(){this.searchBarForm.controls.searchInputField.valueChanges.pipe((0,S.b)(500)).subscribe(e=>{var t;this.loading=!0,this.paginatedListItems=[],this.listItems=[];const r=null===(t=this.searchSelectForm.get("selectSearchField"))||void 0===t?void 0:t.value;r?this.getBooksWithParam({[r]:e}):this.getBooks({list:e||this.dafaultParam.list,date:"current",offset:this.currentPage})})}selectSortFormGroup(){this.searchSelectForm.controls.selectSearchField.valueChanges.subscribe(e=>{var t;const r=null===(t=this.searchBarForm.get("searchInputField"))||void 0===t?void 0:t.value;r&&(this.paginatedListItems=[],this.listItems=[],this.loading=!0,this.getBooksWithParam({[e]:r}))})}}return o.\u0275fac=function(e){return new(e||o)(s.Y36(b),s.Y36(s.R0b))},o.\u0275cmp=s.Xpm({type:o,selectors:[["app-book-page"]],viewQuery:function(e,t){if(1&e&&s.Gf(R,5),2&e){let r;s.iGM(r=s.CRH())&&(t.scroller=r.first)}},decls:18,vars:7,consts:[[3,"title"],[1,"controls-container"],["appearance","fill",3,"formGroup"],["formControlName","selectSearchField"],[3,"value",4,"ngFor","ngForOf"],[1,"search-box"],[3,"formGroup"],["formControlName","searchInputField","type","search","placeholder","Search"],[1,"container"],["itemSize","10",1,"content"],["scroller",""],[4,"cdkVirtualFor","cdkVirtualForOf"],[1,"alerts"],[4,"ngIf"],[3,"value"],[1,"item"],[3,"data"]],template:function(e,t){1&e&&(s.TgZ(0,"app-page-header",0)(1,"div",1)(2,"mat-form-field",2)(3,"mat-label"),s._uU(4,"Search by"),s.qZA(),s.TgZ(5,"mat-select",3),s.YNc(6,Z,2,2,"mat-option",4),s.qZA()(),s.TgZ(7,"div",5)(8,"form",6),s._UZ(9,"input",7),s.qZA()()()(),s.TgZ(10,"div",8)(11,"cdk-virtual-scroll-viewport",9,10)(13,"div"),s.YNc(14,A,4,1,"ng-container",11),s.qZA(),s.TgZ(15,"div",12),s.YNc(16,j,2,0,"h1",13),s.YNc(17,J,2,0,"h1",13),s.qZA()()()),2&e&&(s.Q6J("title",t.pageTitle),s.xp6(2),s.Q6J("formGroup",t.searchSelectForm),s.xp6(4),s.Q6J("ngForOf",t.searchByList),s.xp6(2),s.Q6J("formGroup",t.searchBarForm),s.xp6(6),s.Q6J("cdkVirtualForOf",t.paginatedListItems),s.xp6(2),s.Q6J("ngIf",t.loading),s.xp6(1),s.Q6J("ngIf",!(t.loading||null!=t.paginatedListItems&&t.paginatedListItems.length)))},directives:[E.q,F.KE,p.JL,p.sg,F.hX,U.gD,p.JJ,p.u,f.sg,I.ey,p._Y,p.Fj,g.N7,g.xd,g.x0,C.o,f.O5],styles:[".content[_ngcontent-%COMP%]{height:calc(100vh - 64px);overflow:auto;-ms-overflow-style:none;scrollbar-width:none}.content[_ngcontent-%COMP%]::webkit-scrollbar{display:none}.item[_ngcontent-%COMP%]{margin-bottom:20px}.container[_ngcontent-%COMP%]{padding:20px 0;color:#191616}.controls-container[_ngcontent-%COMP%]{display:flex}"]}),o})()}];let O=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=s.oAB({type:o}),o.\u0275inj=s.cJS({imports:[[y.Bz.forChild(M)],y.Bz]}),o})();var _=a(5601);let W=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=s.oAB({type:o}),o.\u0275inj=s.cJS({providers:[T,b],imports:[[f.ez,O,n.JF,_.m,p.UX]]}),o})()}}]);